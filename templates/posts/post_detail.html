{% extends 'main.html' %}

{% block content %}

<div class="row">
	<div class="col-11">
		<h2 class="mt-3">
			<a href="{% url 'profile' object.user %}" style="color:#ffd343;">@{{ object.user }}</a>: {{ object.title }}
		</h2>
	</div>
	<div class="col-1">
		<form method="POST" class="my-1" enctype="application/x-www-form-urlencoded"
			action="{% url 'submit_positive_vote' %}">
			{% csrf_token %}
			<span style="display:none;">{{ positive_vote_form }}</span>
			<button class="btn {% if not object.user_positive_vote %}btn-primary{% else %}btn-warning{% endif %}">
				<i class="fas fa-plus"></i>
			</button>
		</form>
		<form method="POST" class="my-1" enctype="application/x-www-form-urlencoded"
			action="{% url 'submit_negative_vote' %}">
			{% csrf_token %}
			<span style="display:none;">{{ negative_vote_form }}</span>
			<button class="btn {% if not object.user_negative_vote %}btn-primary{% else %}btn-warning{% endif %}">
				<i class="fas fa-minus"></i>
			</button>
		</form>
	</div>
</div>

<hr style="color:white;">
	{{ object.content }}
<hr>

{% if comments.count > 0 %}
<div class="breadcrumb my-5">
	<ul class="list-group col-12">
	{% for comment in comments %}
		<li class="list-group-item my-3">
			<div class="form-inline">
				<div class="text-left">
					<a href="{% url 'profile' comment.user %}" style="color:#ffd343;">@{{ comment.user }}</a>:
				</div>
				<div class="ml-auto">
					{{ comment.created }}
					{% if comment.user == request.user %}
					<button id="delete_comment_{{ comment.id }}" class="btn btn-danger delete_comment" type="button"><i class="fas fa-trash"></i></button>
					{% endif %}
				</div>
			</div>
			<p>{{ comment.content }}<p>
		</li>
	{% endfor %}
	</ul>
</div>
{% endif %}


{% if user.is_authenticated %}
<form class="breadcrumb my-3" method="POST" enctype="application/x-www-form-urlencoded" action="{% url 'create_comment' %}">
	{% csrf_token %}
	<div class="row col-12 mt-3">
		<h2 class="col-10">Leave a comment:</h2><button class="btn btn-primary col-2">Post Comment</button>
	</div>
	<div class="row col-12 mt-3">
		{% for field in comment_form %}
			{{ field }}
		{% endfor %}
	</div>
</form>
<span style="display:none;" id="delete_comment" class="{% url 'delete_comment' %}"></span>
{% else %}
<div class="breadcrumb my-3">
	<div class="row col-12 mt-3">
		<h2 class="col-10">Leave a comment:</h2><a class="btn btn-primary col-2 my-auto" href="{% url 'signup' %}">Sign up</a>
	</div>
	<div class="row col-12 mt-3">
		<h3><a href="#" style="color:#ffd343;" id="focus_login">Log in</a> or <a href="{% url 'signup' %}" style="color:#ffd343;">sign up</a> to leave a comment.</h3>
	</div>
</div>
{% endif %}

{% endblock %}